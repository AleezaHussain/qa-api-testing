{
	"info": {
		"_postman_id": "ba225725-c7ce-4be7-bfa4-d53f493707f8",
		"name": "API scenario testing",
		"description": "# üñáÔ∏è Get started here\n\nPostman's [scripting](https://learning.postman.com/docs/writing-scripts/intro-to-scripts/) feature allows you to build conditional workflows using a collection. You can branch and loop over a set of requests.\n\nThis template contains a sample conditional workflow for testing successful user creation across a data array.\n\nThe workflow is set to run in successive iterations with different values in each iteration. If the API returns a successful response in an iteration, the next iteration is triggered, and so on. You will get a report of successful user creations when all the iterations are successful. If a user creation fails, the loop is terminated, and you will get a report of the failed attempt.\n\n<img src=\"https://content.pstmn.io/d21cb133-1e04-41f6-9ef6-9aaf85df4e82/aW1hZ2UucG5n\" alt=\"Workflow%20depicting%20the%20collection%20execution\" width=\"638\" height=\"720\">\n\nThe [postman.setNextRequest()](https://learning.postman.com/docs/postman/scripts/branching-and-looping/) function enables you to change the order of requests in a collection while testing. This function allows you to conditionally skip specific requests, repeat requests, terminate the collection early, etc. You can use conditional workflows in various use cases, from [generating a Spotify playlist](https://blog.postman.com/generate-spotify-playlists-using-a-postman-collection/) to [checking your website for broken links](https://blog.postman.com/check-for-broken-links-on-your-website-using-a-postman-collection/).\n\n## üîñ **How to use this template**\n\n**Step 1:** Open the collection and click on the \"View more actions\" icon.\n\n**Step 2:** Click \"Run Collection\" to open the [collection runner](https://learning.postman.com/docs/running-collections/intro-to-collection-runs/).\n\n**Step 3:** Click on \"Run Conditional Workflow\" to run the collection.\n\n#### Modifying the data\n\nYou can find the data array in the collection variables section, which you can navigate to by clicking on the collection's name in the sidebar and then selecting the Variables tab.\n\nThe data array follows this structure:\n\n``` json\n[\n    {\n        \"username\": \"\",\n        \"name\": \"\",\n        \"role\": \"\"\n    },\n    ...\n]\n\n ```\n\n## üí°Related templates\n\n[Async operations](https://go.postman.co/redirect/workspace?type=personal&collectionTemplateId=66c7f0e5-065a-4d08-9c7e-0825e9e29e24&sourceTemplateId=78475d97-9a36-4731-ab24-9adf6a94d0fb)  \n[Data visualization](https://go.postman.co/redirect/workspace?type=personal&collectionTemplateId=c9e72d75-ded7-4135-a721-5d59ddda6d59&sourceTemplateId=78475d97-9a36-4731-ab24-9adf6a94d0fb)  \n[Integration testing](https://go.postman.co/redirect/workspace?type=personal&collectionTemplateId=fe506090-ca91-4340-bea9-82d2c3d2bb9a&sourceTemplateId=78475d97-9a36-4731-ab24-9adf6a94d0fb)  \n[Reusing requests and scripts](https://go.postman.co/redirect/workspace?type=personal&collectionTemplateId=0cb2db53-2dee-430b-a0cf-21f1dbb50bb1&sourceTemplateId=78475d97-9a36-4731-ab24-9adf6a94d0fb)  \n[Run collection with data file](https://go.postman.co/redirect/workspace?type=personal&collectionTemplateId=6a8f6393-58ab-4458-944c-7fc8f08448da&sourceTemplateId=78475d97-9a36-4731-ab24-9adf6a94d0fb)",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "40700050"
	},
	"item": [
		{
			"name": "testing status -get",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"// Parse the data from the variables",
							"const jsonUsers = JSON.parse(pm.collectionVariables.get(\"users\"));",
							"let idx = pm.collectionVariables.get(\"idx\") || 0;",
							"",
							"if (idx < jsonUsers.length) {",
							"    // Select the first element from the array",
							"    let currentUser = jsonUsers[idx];",
							"",
							"    // Store the required information in a variable. This will be used in the request body while sending the request.",
							"    pm.collectionVariables.set(\"username\", currentUser.username);",
							"    pm.collectionVariables.set(\"name\", currentUser.name);",
							"    pm.collectionVariables.set(\"role\", currentUser.role);",
							"",
							"    // Set the active index as a variable",
							"    pm.collectionVariables.set(\"idx\", ++idx);",
							"}",
							"else {",
							"    throw new Error(\"No users left. Terminating the run.\");",
							"}",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "test",
					"script": {
						"exec": [
							"const results = JSON.parse(pm.collectionVariables.get(\"results\"));",
							"const username = pm.collectionVariables.get(\"username\");",
							"",
							"if (pm.response.code === 200) {",
							"    // Mark the test as success",
							"    pm.test(`Success: ${username}`, function () {",
							"        pm.expect(pm.response.code).to.eql(200);",
							"    });",
							"",
							"    // Use the Postman Sandbox API to get more information about the response",
							"    // https://learning.postman.com/docs/writing-scripts/script-references/postman-sandbox-api-reference/",
							"    const response = pm.response.json();",
							"",
							"    // Add the response attributes",
							"    results.push({",
							"        success: true,",
							"        username: username,",
							"        responseAttr: response.data,",
							"        responseCode: pm.response.code",
							"    });",
							"",
							"    // Set the results in a variable",
							"    pm.collectionVariables.set(\"results\", JSON.stringify(results));",
							"",
							"    // Fetch the remaining users list and the current index from the collection variables",
							"    const idx = pm.collectionVariables.get(\"idx\");",
							"    const users = JSON.parse(pm.collectionVariables.get(\"users\"));",
							"",
							"    // Evaluate if there are any more users left to continue the loop or terminate it",
							"    if (idx < users.length) {",
							"        // Add the name of the request that you want to execute next",
							"        postman.setNextRequest(\"Create users based on an array of data\");",
							"    } else {",
							"        // Reset the index for any future runs",
							"        pm.collectionVariables.set(\"idx\", 0);",
							"        // In case, you want to end the workflow, you can also specify `null` to end the execution post this request",
							"        postman.setNextRequest(\"Report Successful User Creation\");",
							"    }",
							"}",
							"else {",
							"    pm.test(`Failure: ${username}`, function () {",
							"        pm.expect(pm.response.code).to.eql(200);",
							"    });",
							"",
							"    // Store the failure results",
							"    results.push({",
							"        success: false,",
							"        username: username,",
							"        responseCode: pm.response.code,",
							"        responseAttr: pm.response.body",
							"    });",
							"",
							"    // Reset the index for any future runs",
							"    pm.collectionVariables.set(\"idx\", 0);",
							"    // Call the failed user creation to report the results",
							"    postman.setNextRequest(\"Report Failed User Creation\");",
							"}",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"username\": \"{{username}}\",\n    \"name\": \"{{name}}\",\n    \"role\": \"{{role}}\"\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{books}}/status",
					"host": [
						"{{books}}"
					],
					"path": [
						"status"
					]
				},
				"description": "This request creates a new user. It runs as many times as the number of elements in the data array.\n\nThe pre-request script sets the current user information in a variable and then uses that variable in the request body.\n\nThe post-response script takes care of storing the response and branching the execution based on the success of the request."
			},
			"response": []
		},
		{
			"name": "testing book - get",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"// Parse the data from the variables",
							"const jsonUsers = JSON.parse(pm.collectionVariables.get(\"users\"));",
							"let idx = pm.collectionVariables.get(\"idx\") || 0;",
							"",
							"if (idx < jsonUsers.length) {",
							"    // Select the first element from the array",
							"    let currentUser = jsonUsers[idx];",
							"",
							"    // Store the required information in a variable. This will be used in the request body while sending the request.",
							"    pm.collectionVariables.set(\"username\", currentUser.username);",
							"    pm.collectionVariables.set(\"name\", currentUser.name);",
							"    pm.collectionVariables.set(\"role\", currentUser.role);",
							"",
							"    // Set the active index as a variable",
							"    pm.collectionVariables.set(\"idx\", ++idx);",
							"}",
							"else {",
							"    throw new Error(\"No users left. Terminating the run.\");",
							"}",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "test",
					"script": {
						"exec": [
							"const results = JSON.parse(pm.collectionVariables.get(\"results\"));",
							"const username = pm.collectionVariables.get(\"username\");",
							"",
							"if (pm.response.code === 200) {",
							"    // Mark the test as success",
							"    pm.test(`Success: ${username}`, function () {",
							"        pm.expect(pm.response.code).to.eql(200);",
							"    });",
							"",
							"    // Use the Postman Sandbox API to get more information about the response",
							"    // https://learning.postman.com/docs/writing-scripts/script-references/postman-sandbox-api-reference/",
							"    const response = pm.response.json();",
							"",
							"    // Add the response attributes",
							"    results.push({",
							"        success: true,",
							"        username: username,",
							"        responseAttr: response.data,",
							"        responseCode: pm.response.code",
							"    });",
							"",
							"    // Set the results in a variable",
							"    pm.collectionVariables.set(\"results\", JSON.stringify(results));",
							"",
							"    // Fetch the remaining users list and the current index from the collection variables",
							"    const idx = pm.collectionVariables.get(\"idx\");",
							"    const users = JSON.parse(pm.collectionVariables.get(\"users\"));",
							"",
							"    // Evaluate if there are any more users left to continue the loop or terminate it",
							"    if (idx < users.length) {",
							"        // Add the name of the request that you want to execute next",
							"        postman.setNextRequest(\"Create users based on an array of data\");",
							"    } else {",
							"        // Reset the index for any future runs",
							"        pm.collectionVariables.set(\"idx\", 0);",
							"        // In case, you want to end the workflow, you can also specify `null` to end the execution post this request",
							"        postman.setNextRequest(\"Report Successful User Creation\");",
							"    }",
							"}",
							"else {",
							"    pm.test(`Failure: ${username}`, function () {",
							"        pm.expect(pm.response.code).to.eql(200);",
							"    });",
							"",
							"    // Store the failure results",
							"    results.push({",
							"        success: false,",
							"        username: username,",
							"        responseCode: pm.response.code,",
							"        responseAttr: pm.response.body",
							"    });",
							"",
							"    // Reset the index for any future runs",
							"    pm.collectionVariables.set(\"idx\", 0);",
							"    // Call the failed user creation to report the results",
							"    postman.setNextRequest(\"Report Failed User Creation\");",
							"}",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"username\": \"{{username}}\",\n    \"name\": \"{{name}}\",\n    \"role\": \"{{role}}\"\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{books}}/books",
					"host": [
						"{{books}}"
					],
					"path": [
						"books"
					]
				},
				"description": "This request creates a new user. It runs as many times as the number of elements in the data array.\n\nThe pre-request script sets the current user information in a variable and then uses that variable in the request body.\n\nThe post-response script takes care of storing the response and branching the execution based on the success of the request."
			},
			"response": []
		},
		{
			"name": "testing book id - get",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"// Parse the data from the variables",
							"const jsonUsers = JSON.parse(pm.collectionVariables.get(\"users\"));",
							"let idx = pm.collectionVariables.get(\"idx\") || 0;",
							"",
							"if (idx < jsonUsers.length) {",
							"    // Select the first element from the array",
							"    let currentUser = jsonUsers[idx];",
							"",
							"    // Store the required information in a variable. This will be used in the request body while sending the request.",
							"    pm.collectionVariables.set(\"username\", currentUser.username);",
							"    pm.collectionVariables.set(\"name\", currentUser.name);",
							"    pm.collectionVariables.set(\"role\", currentUser.role);",
							"",
							"    // Set the active index as a variable",
							"    pm.collectionVariables.set(\"idx\", ++idx);",
							"}",
							"else {",
							"    throw new Error(\"No users left. Terminating the run.\");",
							"}",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "test",
					"script": {
						"exec": [
							"const results = JSON.parse(pm.collectionVariables.get(\"results\"));",
							"const username = pm.collectionVariables.get(\"username\");",
							"",
							"if (pm.response.code === 200) {",
							"    // Mark the test as success",
							"    pm.test(`Success: ${username}`, function () {",
							"        pm.expect(pm.response.code).to.eql(200);",
							"    });",
							"",
							"    // Use the Postman Sandbox API to get more information about the response",
							"    // https://learning.postman.com/docs/writing-scripts/script-references/postman-sandbox-api-reference/",
							"    const response = pm.response.json();",
							"",
							"    // Add the response attributes",
							"    results.push({",
							"        success: true,",
							"        username: username,",
							"        responseAttr: response.data,",
							"        responseCode: pm.response.code",
							"    });",
							"",
							"    // Set the results in a variable",
							"    pm.collectionVariables.set(\"results\", JSON.stringify(results));",
							"",
							"    // Fetch the remaining users list and the current index from the collection variables",
							"    const idx = pm.collectionVariables.get(\"idx\");",
							"    const users = JSON.parse(pm.collectionVariables.get(\"users\"));",
							"",
							"    // Evaluate if there are any more users left to continue the loop or terminate it",
							"    if (idx < users.length) {",
							"        // Add the name of the request that you want to execute next",
							"        postman.setNextRequest(\"Create users based on an array of data\");",
							"    } else {",
							"        // Reset the index for any future runs",
							"        pm.collectionVariables.set(\"idx\", 0);",
							"        // In case, you want to end the workflow, you can also specify `null` to end the execution post this request",
							"        postman.setNextRequest(\"Report Successful User Creation\");",
							"    }",
							"}",
							"else {",
							"    pm.test(`Failure: ${username}`, function () {",
							"        pm.expect(pm.response.code).to.eql(200);",
							"    });",
							"",
							"    // Store the failure results",
							"    results.push({",
							"        success: false,",
							"        username: username,",
							"        responseCode: pm.response.code,",
							"        responseAttr: pm.response.body",
							"    });",
							"",
							"    // Reset the index for any future runs",
							"    pm.collectionVariables.set(\"idx\", 0);",
							"    // Call the failed user creation to report the results",
							"    postman.setNextRequest(\"Report Failed User Creation\");",
							"}",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"method": "GET",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"username\": \"{{username}}\",\n    \"name\": \"{{name}}\",\n    \"role\": \"{{role}}\"\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{books}}/books/2",
					"host": [
						"{{books}}"
					],
					"path": [
						"books",
						"2"
					]
				},
				"description": "This request creates a new user. It runs as many times as the number of elements in the data array.\n\nThe pre-request script sets the current user information in a variable and then uses that variable in the request body.\n\nThe post-response script takes care of storing the response and branching the execution based on the success of the request."
			},
			"response": []
		},
		{
			"name": "testing book order - post",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"// Parse the data from the variables",
							"const jsonUsers = JSON.parse(pm.collectionVariables.get(\"users\"));",
							"let idx = pm.collectionVariables.get(\"idx\") || 0;",
							"",
							"if (idx < jsonUsers.length) {",
							"    // Select the first element from the array",
							"    let currentUser = jsonUsers[idx];",
							"",
							"    // Store the required information in a variable. This will be used in the request body while sending the request.",
							"    pm.collectionVariables.set(\"username\", currentUser.username);",
							"    pm.collectionVariables.set(\"name\", currentUser.name);",
							"    pm.collectionVariables.set(\"role\", currentUser.role);",
							"",
							"    // Set the active index as a variable",
							"    pm.collectionVariables.set(\"idx\", ++idx);",
							"}",
							"else {",
							"    throw new Error(\"No users left. Terminating the run.\");",
							"}",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "test",
					"script": {
						"exec": [
							"const results = JSON.parse(pm.collectionVariables.get(\"results\"));",
							"const username = pm.collectionVariables.get(\"username\");",
							"",
							"if (pm.response.code === 200) {",
							"    // Mark the test as success",
							"    pm.test(`Success: ${username}`, function () {",
							"        pm.expect(pm.response.code).to.eql(200);",
							"    });",
							"",
							"    // Use the Postman Sandbox API to get more information about the response",
							"    // https://learning.postman.com/docs/writing-scripts/script-references/postman-sandbox-api-reference/",
							"    const response = pm.response.json();",
							"",
							"    // Add the response attributes",
							"    results.push({",
							"        success: true,",
							"        username: username,",
							"        responseAttr: response.data,",
							"        responseCode: pm.response.code",
							"    });",
							"",
							"    // Set the results in a variable",
							"    pm.collectionVariables.set(\"results\", JSON.stringify(results));",
							"",
							"    // Fetch the remaining users list and the current index from the collection variables",
							"    const idx = pm.collectionVariables.get(\"idx\");",
							"    const users = JSON.parse(pm.collectionVariables.get(\"users\"));",
							"",
							"    // Evaluate if there are any more users left to continue the loop or terminate it",
							"    if (idx < users.length) {",
							"        // Add the name of the request that you want to execute next",
							"        postman.setNextRequest(\"Create users based on an array of data\");",
							"    } else {",
							"        // Reset the index for any future runs",
							"        pm.collectionVariables.set(\"idx\", 0);",
							"        // In case, you want to end the workflow, you can also specify `null` to end the execution post this request",
							"        postman.setNextRequest(\"Report Successful User Creation\");",
							"    }",
							"}",
							"else {",
							"    pm.test(`Failure: ${username}`, function () {",
							"        pm.expect(pm.response.code).to.eql(200);",
							"    });",
							"",
							"    // Store the failure results",
							"    results.push({",
							"        success: false,",
							"        username: username,",
							"        responseCode: pm.response.code,",
							"        responseAttr: pm.response.body",
							"    });",
							"",
							"    // Reset the index for any future runs",
							"    pm.collectionVariables.set(\"idx\", 0);",
							"    // Call the failed user creation to report the results",
							"    postman.setNextRequest(\"Report Failed User Creation\");",
							"}",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "5a52a54fb39c0d2a8e91a71480c1486ea5ff13e95a77647f9b6f6dedd87a80cf",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "\n{\n  \"bookId\": 1,\n  \"customerName\": \"John\"\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{books}}/orders",
					"host": [
						"{{books}}"
					],
					"path": [
						"orders"
					]
				},
				"description": "This request creates a new user. It runs as many times as the number of elements in the data array.\n\nThe pre-request script sets the current user information in a variable and then uses that variable in the request body.\n\nThe post-response script takes care of storing the response and branching the execution based on the success of the request."
			},
			"response": []
		},
		{
			"name": "all orders -get",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"// Parse the data from the variables",
							"const jsonUsers = JSON.parse(pm.collectionVariables.get(\"users\"));",
							"let idx = pm.collectionVariables.get(\"idx\") || 0;",
							"",
							"if (idx < jsonUsers.length) {",
							"    // Select the first element from the array",
							"    let currentUser = jsonUsers[idx];",
							"",
							"    // Store the required information in a variable. This will be used in the request body while sending the request.",
							"    pm.collectionVariables.set(\"username\", currentUser.username);",
							"    pm.collectionVariables.set(\"name\", currentUser.name);",
							"    pm.collectionVariables.set(\"role\", currentUser.role);",
							"",
							"    // Set the active index as a variable",
							"    pm.collectionVariables.set(\"idx\", ++idx);",
							"}",
							"else {",
							"    throw new Error(\"No users left. Terminating the run.\");",
							"}",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "test",
					"script": {
						"exec": [
							"const results = JSON.parse(pm.collectionVariables.get(\"results\"));",
							"const username = pm.collectionVariables.get(\"username\");",
							"",
							"if (pm.response.code === 200) {",
							"    // Mark the test as success",
							"    pm.test(`Success: ${username}`, function () {",
							"        pm.expect(pm.response.code).to.eql(200);",
							"    });",
							"",
							"    // Use the Postman Sandbox API to get more information about the response",
							"    // https://learning.postman.com/docs/writing-scripts/script-references/postman-sandbox-api-reference/",
							"    const response = pm.response.json();",
							"",
							"    // Add the response attributes",
							"    results.push({",
							"        success: true,",
							"        username: username,",
							"        responseAttr: response.data,",
							"        responseCode: pm.response.code",
							"    });",
							"",
							"    // Set the results in a variable",
							"    pm.collectionVariables.set(\"results\", JSON.stringify(results));",
							"",
							"    // Fetch the remaining users list and the current index from the collection variables",
							"    const idx = pm.collectionVariables.get(\"idx\");",
							"    const users = JSON.parse(pm.collectionVariables.get(\"users\"));",
							"",
							"    // Evaluate if there are any more users left to continue the loop or terminate it",
							"    if (idx < users.length) {",
							"        // Add the name of the request that you want to execute next",
							"        postman.setNextRequest(\"Create users based on an array of data\");",
							"    } else {",
							"        // Reset the index for any future runs",
							"        pm.collectionVariables.set(\"idx\", 0);",
							"        // In case, you want to end the workflow, you can also specify `null` to end the execution post this request",
							"        postman.setNextRequest(\"Report Successful User Creation\");",
							"    }",
							"}",
							"else {",
							"    pm.test(`Failure: ${username}`, function () {",
							"        pm.expect(pm.response.code).to.eql(200);",
							"    });",
							"",
							"    // Store the failure results",
							"    results.push({",
							"        success: false,",
							"        username: username,",
							"        responseCode: pm.response.code,",
							"        responseAttr: pm.response.body",
							"    });",
							"",
							"    // Reset the index for any future runs",
							"    pm.collectionVariables.set(\"idx\", 0);",
							"    // Call the failed user creation to report the results",
							"    postman.setNextRequest(\"Report Failed User Creation\");",
							"}",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "5a52a54fb39c0d2a8e91a71480c1486ea5ff13e95a77647f9b6f6dedd87a80cf",
							"type": "string"
						}
					]
				},
				"method": "GET",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{books}}/orders",
					"host": [
						"{{books}}"
					],
					"path": [
						"orders"
					]
				},
				"description": "This request creates a new user. It runs as many times as the number of elements in the data array.\n\nThe pre-request script sets the current user information in a variable and then uses that variable in the request body.\n\nThe post-response script takes care of storing the response and branching the execution based on the success of the request."
			},
			"response": []
		},
		{
			"name": "order by id -get",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"// Parse the data from the variables",
							"const jsonUsers = JSON.parse(pm.collectionVariables.get(\"users\"));",
							"let idx = pm.collectionVariables.get(\"idx\") || 0;",
							"",
							"if (idx < jsonUsers.length) {",
							"    // Select the first element from the array",
							"    let currentUser = jsonUsers[idx];",
							"",
							"    // Store the required information in a variable. This will be used in the request body while sending the request.",
							"    pm.collectionVariables.set(\"username\", currentUser.username);",
							"    pm.collectionVariables.set(\"name\", currentUser.name);",
							"    pm.collectionVariables.set(\"role\", currentUser.role);",
							"",
							"    // Set the active index as a variable",
							"    pm.collectionVariables.set(\"idx\", ++idx);",
							"}",
							"else {",
							"    throw new Error(\"No users left. Terminating the run.\");",
							"}",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "test",
					"script": {
						"exec": [
							"const results = JSON.parse(pm.collectionVariables.get(\"results\"));",
							"const username = pm.collectionVariables.get(\"username\");",
							"",
							"if (pm.response.code === 200) {",
							"    // Mark the test as success",
							"    pm.test(`Success: ${username}`, function () {",
							"        pm.expect(pm.response.code).to.eql(200);",
							"    });",
							"",
							"    // Use the Postman Sandbox API to get more information about the response",
							"    // https://learning.postman.com/docs/writing-scripts/script-references/postman-sandbox-api-reference/",
							"    const response = pm.response.json();",
							"",
							"    // Add the response attributes",
							"    results.push({",
							"        success: true,",
							"        username: username,",
							"        responseAttr: response.data,",
							"        responseCode: pm.response.code",
							"    });",
							"",
							"    // Set the results in a variable",
							"    pm.collectionVariables.set(\"results\", JSON.stringify(results));",
							"",
							"    // Fetch the remaining users list and the current index from the collection variables",
							"    const idx = pm.collectionVariables.get(\"idx\");",
							"    const users = JSON.parse(pm.collectionVariables.get(\"users\"));",
							"",
							"    // Evaluate if there are any more users left to continue the loop or terminate it",
							"    if (idx < users.length) {",
							"        // Add the name of the request that you want to execute next",
							"        postman.setNextRequest(\"Create users based on an array of data\");",
							"    } else {",
							"        // Reset the index for any future runs",
							"        pm.collectionVariables.set(\"idx\", 0);",
							"        // In case, you want to end the workflow, you can also specify `null` to end the execution post this request",
							"        postman.setNextRequest(\"Report Successful User Creation\");",
							"    }",
							"}",
							"else {",
							"    pm.test(`Failure: ${username}`, function () {",
							"        pm.expect(pm.response.code).to.eql(200);",
							"    });",
							"",
							"    // Store the failure results",
							"    results.push({",
							"        success: false,",
							"        username: username,",
							"        responseCode: pm.response.code,",
							"        responseAttr: pm.response.body",
							"    });",
							"",
							"    // Reset the index for any future runs",
							"    pm.collectionVariables.set(\"idx\", 0);",
							"    // Call the failed user creation to report the results",
							"    postman.setNextRequest(\"Report Failed User Creation\");",
							"}",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "5a52a54fb39c0d2a8e91a71480c1486ea5ff13e95a77647f9b6f6dedd87a80cf",
							"type": "string"
						}
					]
				},
				"method": "GET",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{books}}/orders/E2W0W0Ojxo2RWJ9E1hseo",
					"host": [
						"{{books}}"
					],
					"path": [
						"orders",
						"E2W0W0Ojxo2RWJ9E1hseo"
					]
				},
				"description": "This request creates a new user. It runs as many times as the number of elements in the data array.\n\nThe pre-request script sets the current user information in a variable and then uses that variable in the request body.\n\nThe post-response script takes care of storing the response and branching the execution based on the success of the request."
			},
			"response": []
		},
		{
			"name": "customer name -patch",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"// Parse the data from the variables",
							"const jsonUsers = JSON.parse(pm.collectionVariables.get(\"users\"));",
							"let idx = pm.collectionVariables.get(\"idx\") || 0;",
							"",
							"if (idx < jsonUsers.length) {",
							"    // Select the first element from the array",
							"    let currentUser = jsonUsers[idx];",
							"",
							"    // Store the required information in a variable. This will be used in the request body while sending the request.",
							"    pm.collectionVariables.set(\"username\", currentUser.username);",
							"    pm.collectionVariables.set(\"name\", currentUser.name);",
							"    pm.collectionVariables.set(\"role\", currentUser.role);",
							"",
							"    // Set the active index as a variable",
							"    pm.collectionVariables.set(\"idx\", ++idx);",
							"}",
							"else {",
							"    throw new Error(\"No users left. Terminating the run.\");",
							"}",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "test",
					"script": {
						"exec": [
							"const results = JSON.parse(pm.collectionVariables.get(\"results\"));",
							"const username = pm.collectionVariables.get(\"username\");",
							"",
							"if (pm.response.code === 200) {",
							"    // Mark the test as success",
							"    pm.test(`Success: ${username}`, function () {",
							"        pm.expect(pm.response.code).to.eql(200);",
							"    });",
							"",
							"    // Use the Postman Sandbox API to get more information about the response",
							"    // https://learning.postman.com/docs/writing-scripts/script-references/postman-sandbox-api-reference/",
							"    const response = pm.response.json();",
							"",
							"    // Add the response attributes",
							"    results.push({",
							"        success: true,",
							"        username: username,",
							"        responseAttr: response.data,",
							"        responseCode: pm.response.code",
							"    });",
							"",
							"    // Set the results in a variable",
							"    pm.collectionVariables.set(\"results\", JSON.stringify(results));",
							"",
							"    // Fetch the remaining users list and the current index from the collection variables",
							"    const idx = pm.collectionVariables.get(\"idx\");",
							"    const users = JSON.parse(pm.collectionVariables.get(\"users\"));",
							"",
							"    // Evaluate if there are any more users left to continue the loop or terminate it",
							"    if (idx < users.length) {",
							"        // Add the name of the request that you want to execute next",
							"        postman.setNextRequest(\"Create users based on an array of data\");",
							"    } else {",
							"        // Reset the index for any future runs",
							"        pm.collectionVariables.set(\"idx\", 0);",
							"        // In case, you want to end the workflow, you can also specify `null` to end the execution post this request",
							"        postman.setNextRequest(\"Report Successful User Creation\");",
							"    }",
							"}",
							"else {",
							"    pm.test(`Failure: ${username}`, function () {",
							"        pm.expect(pm.response.code).to.eql(200);",
							"    });",
							"",
							"    // Store the failure results",
							"    results.push({",
							"        success: false,",
							"        username: username,",
							"        responseCode: pm.response.code,",
							"        responseAttr: pm.response.body",
							"    });",
							"",
							"    // Reset the index for any future runs",
							"    pm.collectionVariables.set(\"idx\", 0);",
							"    // Call the failed user creation to report the results",
							"    postman.setNextRequest(\"Report Failed User Creation\");",
							"}",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "5a52a54fb39c0d2a8e91a71480c1486ea5ff13e95a77647f9b6f6dedd87a80cf",
							"type": "string"
						}
					]
				},
				"method": "PATCH",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"customerName\": \"Jane\"\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{books}}/orders/E2W0W0Ojxo2RWJ9E1hseo",
					"host": [
						"{{books}}"
					],
					"path": [
						"orders",
						"E2W0W0Ojxo2RWJ9E1hseo"
					]
				},
				"description": "This request creates a new user. It runs as many times as the number of elements in the data array.\n\nThe pre-request script sets the current user information in a variable and then uses that variable in the request body.\n\nThe post-response script takes care of storing the response and branching the execution based on the success of the request."
			},
			"response": []
		},
		{
			"name": "orderid - delete",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"// Parse the data from the variables",
							"const jsonUsers = JSON.parse(pm.collectionVariables.get(\"users\"));",
							"let idx = pm.collectionVariables.get(\"idx\") || 0;",
							"",
							"if (idx < jsonUsers.length) {",
							"    // Select the first element from the array",
							"    let currentUser = jsonUsers[idx];",
							"",
							"    // Store the required information in a variable. This will be used in the request body while sending the request.",
							"    pm.collectionVariables.set(\"username\", currentUser.username);",
							"    pm.collectionVariables.set(\"name\", currentUser.name);",
							"    pm.collectionVariables.set(\"role\", currentUser.role);",
							"",
							"    // Set the active index as a variable",
							"    pm.collectionVariables.set(\"idx\", ++idx);",
							"}",
							"else {",
							"    throw new Error(\"No users left. Terminating the run.\");",
							"}",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "test",
					"script": {
						"exec": [
							"const results = JSON.parse(pm.collectionVariables.get(\"results\"));",
							"const username = pm.collectionVariables.get(\"username\");",
							"",
							"if (pm.response.code === 200) {",
							"    // Mark the test as success",
							"    pm.test(`Success: ${username}`, function () {",
							"        pm.expect(pm.response.code).to.eql(200);",
							"    });",
							"",
							"    // Use the Postman Sandbox API to get more information about the response",
							"    // https://learning.postman.com/docs/writing-scripts/script-references/postman-sandbox-api-reference/",
							"    const response = pm.response.json();",
							"",
							"    // Add the response attributes",
							"    results.push({",
							"        success: true,",
							"        username: username,",
							"        responseAttr: response.data,",
							"        responseCode: pm.response.code",
							"    });",
							"",
							"    // Set the results in a variable",
							"    pm.collectionVariables.set(\"results\", JSON.stringify(results));",
							"",
							"    // Fetch the remaining users list and the current index from the collection variables",
							"    const idx = pm.collectionVariables.get(\"idx\");",
							"    const users = JSON.parse(pm.collectionVariables.get(\"users\"));",
							"",
							"    // Evaluate if there are any more users left to continue the loop or terminate it",
							"    if (idx < users.length) {",
							"        // Add the name of the request that you want to execute next",
							"        postman.setNextRequest(\"Create users based on an array of data\");",
							"    } else {",
							"        // Reset the index for any future runs",
							"        pm.collectionVariables.set(\"idx\", 0);",
							"        // In case, you want to end the workflow, you can also specify `null` to end the execution post this request",
							"        postman.setNextRequest(\"Report Successful User Creation\");",
							"    }",
							"}",
							"else {",
							"    pm.test(`Failure: ${username}`, function () {",
							"        pm.expect(pm.response.code).to.eql(200);",
							"    });",
							"",
							"    // Store the failure results",
							"    results.push({",
							"        success: false,",
							"        username: username,",
							"        responseCode: pm.response.code,",
							"        responseAttr: pm.response.body",
							"    });",
							"",
							"    // Reset the index for any future runs",
							"    pm.collectionVariables.set(\"idx\", 0);",
							"    // Call the failed user creation to report the results",
							"    postman.setNextRequest(\"Report Failed User Creation\");",
							"}",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "5a52a54fb39c0d2a8e91a71480c1486ea5ff13e95a77647f9b6f6dedd87a80cf",
							"type": "string"
						}
					]
				},
				"method": "DELETE",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\n    \"username\": \"{{username}}\",\n    \"name\": \"{{name}}\",\n    \"role\": \"{{role}}\"\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{books}}/orders/E2W0W0Ojxo2RWJ9E1hseo",
					"host": [
						"{{books}}"
					],
					"path": [
						"orders",
						"E2W0W0Ojxo2RWJ9E1hseo"
					]
				},
				"description": "This request creates a new user. It runs as many times as the number of elements in the data array.\n\nThe pre-request script sets the current user information in a variable and then uses that variable in the request body.\n\nThe post-response script takes care of storing the response and branching the execution based on the success of the request."
			},
			"response": []
		},
		{
			"name": "script to extract common tag with assertion",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Response status is 200\", function () {\r",
							"    // Check if the response is defined and has a status code\r",
							"    pm.response.to.have.status(200); // Assert that the status code is 200\r",
							"});\r",
							"\r",
							"pm.test(\"Response contains countries with 'common' names\", function () {\r",
							"    // Ensure that the response has a body and is in JSON format\r",
							"    const responseBody = pm.response.json();\r",
							"\r",
							"    // Loop through each country in the response\r",
							"    responseBody.forEach(country => {\r",
							"        // Check if 'common' property exists in the 'name' object\r",
							"        pm.expect(country.name).to.have.property('common'); // Assert 'common' property exists\r",
							"        pm.expect(country.name.common).to.be.a('string');  // Assert 'common' is a string\r",
							"    });\r",
							"});\r",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"pm.test(\"Response status is 200\", function () {\r",
							"    pm.response.to.have.status(200); // Assert that the status code is 200\r",
							"});\r",
							"\r",
							"pm.test(\"Response contains countries with 'common' names\", function () {\r",
							"    try {\r",
							"        // Check if the response is a valid JSON\r",
							"        let jsonResponse = pm.response.json();\r",
							"\r",
							"        // Loop through the response and extract the 'common' names\r",
							"        jsonResponse.forEach(country => {\r",
							"            let commonName = country.name?.common;  // Optional chaining for safety\r",
							"            if (commonName) {\r",
							"                console.log(\"Common Name:\", commonName);  // Log the common name\r",
							"            } else {\r",
							"                console.log(\"Common name not found for a country.\");\r",
							"            }\r",
							"        });\r",
							"    } catch (e) {\r",
							"        console.error(\"Error parsing JSON response:\", e.message);  // Handle any JSON parsing errors\r",
							"    }\r",
							"});\r",
							""
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "5a52a54fb39c0d2a8e91a71480c1486ea5ff13e95a77647f9b6f6dedd87a80cf",
							"type": "string"
						}
					]
				},
				"method": "GET",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{countries}}/all",
					"host": [
						"{{countries}}"
					],
					"path": [
						"all"
					]
				},
				"description": "This request creates a new user. It runs as many times as the number of elements in the data array.\n\nThe pre-request script sets the current user information in a variable and then uses that variable in the request body.\n\nThe post-response script takes care of storing the response and branching the execution based on the success of the request."
			},
			"response": []
		},
		{
			"name": "faling test",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"pm.test(\"Response status is 404\", function () {\r",
							"    pm.response.to.have.status(404);  // This will fail because the status code is 200\r",
							"});\r",
							"\r",
							"pm.test(\"Response contains countries without 'common' names\", function () {\r",
							"    try {\r",
							"        // Check if the response body exists and is JSON\r",
							"        let contentType = pm.response.headers.get('Content-Type');\r",
							"        if (contentType && contentType.includes('application/json')) {\r",
							"            let jsonResponse = pm.response.json();\r",
							"\r",
							"            jsonResponse.forEach(country => {\r",
							"                pm.expect(country.name).to.not.have.property('common');  // This will fail if 'common' property exists\r",
							"                pm.expect(country.name.common).to.not.be.a('string');  // This will fail if 'common' is a string\r",
							"            });\r",
							"        } else {\r",
							"            pm.expect.fail(\"Response is not in JSON format. Content-Type: \" + contentType);\r",
							"        }\r",
							"    } catch (error) {\r",
							"        pm.expect.fail(\"Error parsing JSON response: \" + error.message);\r",
							"    }\r",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "test",
					"script": {
						"exec": [
							"try {\r",
							"    let jsonResponse = pm.response.json();\r",
							"\r",
							"    if (Array.isArray(jsonResponse) && jsonResponse.length > 0) {\r",
							"        let commonTags = jsonResponse.map(country => country?.name?.common).filter(Boolean);\r",
							"\r",
							"        if (commonTags.length > 0) {\r",
							"            console.log(\"Number of Countries:\", commonTags.length);\r",
							"            console.log(\"Sample Common Tags:\", commonTags.slice(0, 10)); // Display a sample of the tags\r",
							"        } else {\r",
							"            console.log(\"No 'common' tags found in the response.\");\r",
							"        }\r",
							"    } else {\r",
							"        console.log(\"Response is not an array or is empty.\");\r",
							"    }\r",
							"} catch (error) {\r",
							"    console.error(\"Error parsing response or accessing properties:\", error.message);\r",
							"}"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "noauth"
				},
				"method": "GET",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{countries}}/all",
					"host": [
						"{{countries}}"
					],
					"path": [
						"all"
					]
				},
				"description": "This request creates a new user. It runs as many times as the number of elements in the data array.\n\nThe pre-request script sets the current user information in a variable and then uses that variable in the request body.\n\nThe post-response script takes care of storing the response and branching the execution based on the success of the request."
			},
			"response": []
		},
		{
			"name": "setting variables",
			"event": [
				{
					"listen": "prerequest",
					"script": {
						"exec": [
							"pm.variables.set(\"countryName\", \"india\");  "
						],
						"type": "text/javascript",
						"packages": {}
					}
				},
				{
					"listen": "test",
					"script": {
						"exec": [
							"pm.test(\"Country name is found in response\", function () {",
							"    let jsonResponse = pm.response.json();",
							"    let countryName = jsonResponse[0].name.common.toLowerCase();  // Convert response to lower case",
							"",
							"    // Compare the country name with the value in lower case",
							"    pm.expect(countryName).to.eql(\"india\");  // Ensure the comparison is case-insensitive",
							"});"
						],
						"type": "text/javascript",
						"packages": {}
					}
				}
			],
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "5a52a54fb39c0d2a8e91a71480c1486ea5ff13e95a77647f9b6f6dedd87a80cf",
							"type": "string"
						}
					]
				},
				"method": "GET",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{countries}}/name/{{countryName}}?fullText=true",
					"host": [
						"{{countries}}"
					],
					"path": [
						"name",
						"{{countryName}}"
					],
					"query": [
						{
							"key": "fullText",
							"value": "true"
						}
					]
				},
				"description": "This request creates a new user. It runs as many times as the number of elements in the data array.\n\nThe pre-request script sets the current user information in a variable and then uses that variable in the request body.\n\nThe post-response script takes care of storing the response and branching the execution based on the success of the request."
			},
			"response": []
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "users",
			"value": "[{\"username\": \"flash\",\"name\": \"Barry Allen\",\"role\": \"Superhero\"},{\"username\": \"wonder_woman\",\"name\": \"Diana Prince\",\"role\":\"Superhero\"},{\"username\": \"batman\",\"name\": \"Bruce Wayne\",\"role\": \"Superhero\"}]"
		},
		{
			"key": "results",
			"value": "[]",
			"type": "string"
		},
		{
			"key": "successAPIUrl",
			"value": "https://postman-echo.com/post",
			"type": "string"
		},
		{
			"key": "failureAPIUrl",
			"value": "https://postman-echo.com/post",
			"type": "string"
		},
		{
			"key": "idx",
			"value": "0"
		},
		{
			"key": "username",
			"value": ""
		},
		{
			"key": "name",
			"value": ""
		},
		{
			"key": "role",
			"value": ""
		}
	]
}